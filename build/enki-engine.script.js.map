{"version":3,"sources":["webpack://EnkiEngine/webpack/bootstrap","webpack://EnkiEngine/./node_modules/uuid/dist/esm-browser/bytesToUuid.js","webpack://EnkiEngine/./node_modules/uuid/dist/esm-browser/index.js","webpack://EnkiEngine/./node_modules/uuid/dist/esm-browser/md5.js","webpack://EnkiEngine/./node_modules/uuid/dist/esm-browser/rng.js","webpack://EnkiEngine/./node_modules/uuid/dist/esm-browser/sha1.js","webpack://EnkiEngine/./node_modules/uuid/dist/esm-browser/v1.js","webpack://EnkiEngine/./node_modules/uuid/dist/esm-browser/v3.js","webpack://EnkiEngine/./node_modules/uuid/dist/esm-browser/v35.js","webpack://EnkiEngine/./node_modules/uuid/dist/esm-browser/v4.js","webpack://EnkiEngine/./node_modules/uuid/dist/esm-browser/v5.js","webpack://EnkiEngine/./src/componentManager.js","webpack://EnkiEngine/./src/entityManager.js","webpack://EnkiEngine/./src/index.js","webpack://EnkiEngine/./src/storage/index.js","webpack://EnkiEngine/./src/storage/memoryStorage.js","webpack://EnkiEngine/./src/systemManager.js","webpack://EnkiEngine/./src/templateManager.js","webpack://EnkiEngine/./src/utils/errors.js","webpack://EnkiEngine/./src/utils/validate.js"],"names":["ComponentManager","storage","verbose","_storage","_registeredComponents","Map","_log","$msg","console","log","_validate","ComponentId","componentValue","c","get","Object","entries","k","v","validateFunctionName","charAt","toUpperCase","slice","optional","type","args","push","allowed","childType","Validate","defaultSchema","keys","includes","add","entityId","ComponentName","value","defaultValues","fromEntries","map","addEntityComponent","assign","remove","removeEntityComponent","register","componentSchema","hasOwnProperty","name","data","set","list","isRegistered","has","EntityManager","id","entity","addEntity","removeEntity","getEntity","getEntities","values","Engine","storageType","mode","storageInstance","rest","Storage","entityMgr","componentMgr","systemMgr","templateMgr","SystemManager","TemplateManager","MemoryStorage","state","_verbose","Entities","Set","ComponentMap","EntityComponents","componentsName","forEach","e","undefined","getEntityComponents","getEntityByComponents","components","Array","isArray","Error","reduce","acc","val","size","filter","i","componentName","component","getState","_registeredSystems","_registerEvents","_query","q","system","query","events","res","execute","returnValues","entities","instance","registerEvent","eventName","triggerEvent","eventData","_registeredTemplates","registerComponents","ValidationError","length","create","templateName","template","d","err","message","isNumber","isNaN","isAny","isString","String","isEnum","cur","isComponent","isMap","from","isSet"],"mappings":";;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AACA;AACA;AACA;AACA;;AAEA,eAAe,SAAS;AACxB;AACA;;AAEA;AACA,4BAA4B;AAC5B;;AAEA;AACA;;AAEe,0EAAW,E;;;;;;;;;;;;ACjB1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACA;AACA;;;;;;;;;;;;;ACFxC;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD;;AAElD;;AAEA,mBAAmB,gBAAgB;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA,iBAAiB,cAAc;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,cAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,iBAAiB,aAAa;AAC9B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEe,kEAAG,E;;;;;;;;;;;;ACtNlB;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACe;AACf;AACA;AACA;;AAEA;AACA,C;;;;;;;;;;;;ACbA;AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kDAAkD;;AAElD;;AAEA,mBAAmB,gBAAgB;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,kBAAkB,QAAQ;AAC1B;;AAEA,mBAAmB,QAAQ;AAC3B;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,SAAS;AAC5B;;AAEA,mBAAmB,QAAQ;AAC3B;AACA;;AAEA,qBAAqB,SAAS;AAC9B;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,qBAAqB,UAAU;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEe,mEAAI,E;;;;;;;;;;;;AC5FnB;AAAA;AAAA;AAA2B;AACgB;AAC3C;AACA;AACA;;AAEA;;A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","file":"enki-engine.script.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction bytesToUuid(buf, offset_) {\n  var offset = offset_ || 0; // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n\n  return (byteToHex[buf[offset + 0]] + byteToHex[buf[offset + 1]] + byteToHex[buf[offset + 2]] + byteToHex[buf[offset + 3]] + '-' + byteToHex[buf[offset + 4]] + byteToHex[buf[offset + 5]] + '-' + byteToHex[buf[offset + 6]] + byteToHex[buf[offset + 7]] + '-' + byteToHex[buf[offset + 8]] + byteToHex[buf[offset + 9]] + '-' + byteToHex[buf[offset + 10]] + byteToHex[buf[offset + 11]] + byteToHex[buf[offset + 12]] + byteToHex[buf[offset + 13]] + byteToHex[buf[offset + 14]] + byteToHex[buf[offset + 15]]).toLowerCase();\n}\n\nexport default bytesToUuid;","export { default as v1 } from './v1.js';\nexport { default as v3 } from './v3.js';\nexport { default as v4 } from './v4.js';\nexport { default as v5 } from './v5.js';","/*\n * Browser-compatible JavaScript MD5\n *\n * Modification of JavaScript MD5\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\nfunction md5(bytes) {\n  if (typeof bytes === 'string') {\n    var msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = new Uint8Array(msg.length);\n\n    for (var i = 0; i < msg.length; ++i) {\n      bytes[i] = msg.charCodeAt(i);\n    }\n  }\n\n  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));\n}\n/*\n * Convert an array of little-endian words to an array of bytes\n */\n\n\nfunction md5ToHexEncodedArray(input) {\n  var output = [];\n  var length32 = input.length * 32;\n  var hexTab = '0123456789abcdef';\n\n  for (var i = 0; i < length32; i += 8) {\n    var x = input[i >> 5] >>> i % 32 & 0xff;\n    var hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);\n    output.push(hex);\n  }\n\n  return output;\n}\n/**\n * Calculate output length with padding and bit length\n */\n\n\nfunction getOutputLength(inputLength8) {\n  return (inputLength8 + 64 >>> 9 << 4) + 14 + 1;\n}\n/*\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n */\n\n\nfunction wordsToMd5(x, len) {\n  /* append padding */\n  x[len >> 5] |= 0x80 << len % 32;\n  x[getOutputLength(len) - 1] = len;\n  var a = 1732584193;\n  var b = -271733879;\n  var c = -1732584194;\n  var d = 271733878;\n\n  for (var i = 0; i < x.length; i += 16) {\n    var olda = a;\n    var oldb = b;\n    var oldc = c;\n    var oldd = d;\n    a = md5ff(a, b, c, d, x[i], 7, -680876936);\n    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n    b = md5gg(b, c, d, a, x[i], 20, -373897302);\n    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n    d = md5hh(d, a, b, c, x[i], 11, -358537222);\n    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n    a = md5ii(a, b, c, d, x[i], 6, -198630844);\n    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n    a = safeAdd(a, olda);\n    b = safeAdd(b, oldb);\n    c = safeAdd(c, oldc);\n    d = safeAdd(d, oldd);\n  }\n\n  return [a, b, c, d];\n}\n/*\n * Convert an array bytes to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n */\n\n\nfunction bytesToWords(input) {\n  if (input.length === 0) {\n    return [];\n  }\n\n  var length8 = input.length * 8;\n  var output = new Uint32Array(getOutputLength(length8));\n\n  for (var i = 0; i < length8; i += 8) {\n    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;\n  }\n\n  return output;\n}\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\n\n\nfunction safeAdd(x, y) {\n  var lsw = (x & 0xffff) + (y & 0xffff);\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return msw << 16 | lsw & 0xffff;\n}\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\n\n\nfunction bitRotateLeft(num, cnt) {\n  return num << cnt | num >>> 32 - cnt;\n}\n/*\n * These functions implement the four basic operations the algorithm uses.\n */\n\n\nfunction md5cmn(q, a, b, x, s, t) {\n  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n\nfunction md5ff(a, b, c, d, x, s, t) {\n  return md5cmn(b & c | ~b & d, a, b, x, s, t);\n}\n\nfunction md5gg(a, b, c, d, x, s, t) {\n  return md5cmn(b & d | c & ~d, a, b, x, s, t);\n}\n\nfunction md5hh(a, b, c, d, x, s, t) {\n  return md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n\nfunction md5ii(a, b, c, d, x, s, t) {\n  return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\nexport default md5;","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  if (!getRandomValues) {\n    throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n  }\n\n  return getRandomValues(rnds8);\n}","// Adapted from Chris Veness' SHA1 code at\n// http://www.movable-type.co.uk/scripts/sha1.html\nfunction f(s, x, y, z) {\n  switch (s) {\n    case 0:\n      return x & y ^ ~x & z;\n\n    case 1:\n      return x ^ y ^ z;\n\n    case 2:\n      return x & y ^ x & z ^ y & z;\n\n    case 3:\n      return x ^ y ^ z;\n  }\n}\n\nfunction ROTL(x, n) {\n  return x << n | x >>> 32 - n;\n}\n\nfunction sha1(bytes) {\n  var K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n  var H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n\n  if (typeof bytes === 'string') {\n    var msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = [];\n\n    for (var i = 0; i < msg.length; ++i) {\n      bytes.push(msg.charCodeAt(i));\n    }\n  }\n\n  bytes.push(0x80);\n  var l = bytes.length / 4 + 2;\n  var N = Math.ceil(l / 16);\n  var M = new Array(N);\n\n  for (var _i = 0; _i < N; ++_i) {\n    var arr = new Uint32Array(16);\n\n    for (var j = 0; j < 16; ++j) {\n      arr[j] = bytes[_i * 64 + j * 4] << 24 | bytes[_i * 64 + j * 4 + 1] << 16 | bytes[_i * 64 + j * 4 + 2] << 8 | bytes[_i * 64 + j * 4 + 3];\n    }\n\n    M[_i] = arr;\n  }\n\n  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);\n  M[N - 1][14] = Math.floor(M[N - 1][14]);\n  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;\n\n  for (var _i2 = 0; _i2 < N; ++_i2) {\n    var W = new Uint32Array(80);\n\n    for (var t = 0; t < 16; ++t) {\n      W[t] = M[_i2][t];\n    }\n\n    for (var _t = 16; _t < 80; ++_t) {\n      W[_t] = ROTL(W[_t - 3] ^ W[_t - 8] ^ W[_t - 14] ^ W[_t - 16], 1);\n    }\n\n    var a = H[0];\n    var b = H[1];\n    var c = H[2];\n    var d = H[3];\n    var e = H[4];\n\n    for (var _t2 = 0; _t2 < 80; ++_t2) {\n      var s = Math.floor(_t2 / 20);\n      var T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[_t2] >>> 0;\n      e = d;\n      d = c;\n      c = ROTL(b, 30) >>> 0;\n      b = a;\n      a = T;\n    }\n\n    H[0] = H[0] + a >>> 0;\n    H[1] = H[1] + b >>> 0;\n    H[2] = H[2] + c >>> 0;\n    H[3] = H[3] + d >>> 0;\n    H[4] = H[4] + e >>> 0;\n  }\n\n  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];\n}\n\nexport default sha1;","import rng from './rng.js';\nimport bytesToUuid from './bytesToUuid.js'; // **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\n\nvar _clockseq; // Previous uuid creation time\n\n\nvar _lastMSecs = 0;\nvar _lastNSecs = 0; // See https://github.com/uuidjs/uuid for API details\n\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || new Array(16);\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq; // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n\n  if (node == null || clockseq == null) {\n    var seedBytes = options.random || (options.rng || rng)();\n\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [seedBytes[0] | 0x01, seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]];\n    }\n\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  } // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n\n\n  var msecs = options.msecs !== undefined ? options.msecs : Date.now(); // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1; // Time since last uuid creation (in msecs)\n\n  var dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 10000; // Per 4.2.1.2, Bump clockseq on clock regression\n\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  } // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n\n\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  } // Per 4.2.1.2 Throw error if too many uuids are requested\n\n\n  if (nsecs >= 10000) {\n    throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq; // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n\n  msecs += 12219292800000; // `time_low`\n\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff; // `time_mid`\n\n  var tmh = msecs / 0x100000000 * 10000 & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff; // `time_high_and_version`\n\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n\n  b[i++] = tmh >>> 16 & 0xff; // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n\n  b[i++] = clockseq >>> 8 | 0x80; // `clock_seq_low`\n\n  b[i++] = clockseq & 0xff; // `node`\n\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf || bytesToUuid(b);\n}\n\nexport default v1;","import v35 from './v35.js';\nimport md5 from './md5.js';\nvar v3 = v35('v3', 0x30, md5);\nexport default v3;","import bytesToUuid from './bytesToUuid.js';\n\nfunction uuidToBytes(uuid) {\n  // Note: We assume we're being passed a valid uuid string\n  var bytes = [];\n  uuid.replace(/[a-fA-F0-9]{2}/g, function (hex) {\n    bytes.push(parseInt(hex, 16));\n  });\n  return bytes;\n}\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  var bytes = [];\n\n  for (var i = 0; i < str.length; ++i) {\n    bytes.push(str.charCodeAt(i));\n  }\n\n  return bytes;\n}\n\nexport var DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexport var URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexport default function (name, version, hashfunc) {\n  function generateUUID(value, namespace, buf, offset) {\n    if (typeof value === 'string') {\n      value = stringToBytes(value);\n    }\n\n    if (typeof namespace === 'string') {\n      namespace = uuidToBytes(namespace);\n    }\n\n    if (!Array.isArray(value)) {\n      throw TypeError('value must be an array of bytes');\n    }\n\n    if (!Array.isArray(namespace) || namespace.length !== 16) {\n      throw TypeError('namespace must be uuid string or an Array of 16 byte values');\n    } // Per 4.3\n\n\n    var bytes = hashfunc(namespace.concat(value));\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      offset = offset || 0;\n\n      for (var i = 0; i < 16; ++i) {\n        buf[offset + i] = bytes[i];\n      }\n\n      return buf;\n    }\n\n    return bytesToUuid(bytes);\n  } // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name; // eslint-disable-next-line no-empty\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}","import rng from './rng.js';\nimport bytesToUuid from './bytesToUuid.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return bytesToUuid(rnds);\n}\n\nexport default v4;","import v35 from './v35.js';\nimport sha1 from './sha1.js';\nvar v5 = v35('v5', 0x50, sha1);\nexport default v5;","import * as Validate from './utils/validate';\n\nexport const ComponentManager = (storage, verbose) => {\n\n  const _storage = storage;\n  const _registeredComponents = new Map();\n\n  const _log = (...$msg) => {\n    if (verbose) {\n      console.log('Component Manager: ', ...$msg);\n    }\n  };\n\n  const _validate = (ComponentId, componentValue) => {\n    //check if component is registered\n    const c = _registeredComponents.get(ComponentId);\n    if (typeof c === 'undefined') {\n      _log(`Component ${ComponentId} is not registered`);\n      return false;\n    }\n\n    //check if values are correct\n    for (let [k, v] of Object.entries(c)) {\n      const validateFunctionName = 'is' + v['type'].charAt(0).toUpperCase() + v['type'].slice(1);\n      //if value is not passed and we have a default or value is optional then we are good\n      if (typeof componentValue[k] === 'undefined' && (\n        (typeof (v.optional) !== 'undefined' && v.optional === true) ||\n        typeof (v.default) !== 'undefined')\n      ) {\n        continue;\n      }\n      // 'any' type of data is not validated.\n      if(v.type == 'any'){\n        continue;\n      }\n      //we have a value so we test\n      let args = [];\n      if(v.type == 'enum') {\n        args.push(v.allowed);\n      }\n      if(v.type == 'array'){\n        args.push(v.childType);\n      }\n      if (!Validate[validateFunctionName](componentValue[k],...args)) {\n        _log(`${k} => ${componentValue[k]} failed the validation ${validateFunctionName}`);\n        return false;\n      }\n    }\n\n    //check if extra non existent property were passed to component\n    const defaultSchema = Object.keys(c);\n    for (const k of Object.keys(componentValue)) {\n      if (!defaultSchema.includes(k)) {\n        _log(`${k} is not a valid property for the ${ComponentId} Component.`);\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  /**\n   * Add a Component to an existing entity\n   * @param {any} entityId - Entity Id\n   * @param {string} ComponentId - Component type to add\n   * @param {object} value - Object following the data structure of component to pass initial values to component\n   * @returns {boolean} True if succesfull else false\n   */\n  const add = (entityId, ComponentName, value = {}) => {\n    if (_validate(ComponentName, value)) {\n      const c = _registeredComponents.get(ComponentName);\n      const defaultValues = Object.fromEntries(Object.entries(c).map(([k, v]) => {\n        return [k, v.default];\n      }));\n      _storage.addEntityComponent(entityId, ComponentName, Object.assign(defaultValues, value));\n      return true;\n    } else {\n      _log(`Component ${ComponentName} could not added to ${entityId} due to fail validation.`);\n      return false;\n    }\n  };\n\n  /**\n   * Remove a component from an existing Entity\n   * @param {any} entityId - Entity Id\n   * @param {string} ComponentName - Component to remove\n   * @returns {boolean} - True if successfull else false\n   */\n  const remove = (entityId, ComponentName) => {\n    return _storage.removeEntityComponent(entityId, ComponentName);\n  };\n\n  /**\n   * Register a new component type\n   * @param {object} componentSchema\n   * @returns {boolean} - True if successfull, else false\n   */\n  const register = (componentSchema) => {\n    if(!componentSchema.hasOwnProperty('name')) {\n      return false;\n    }\n    _log(`Registering ${componentSchema.name} Component`)\n    const data = componentSchema.data || {};\n    _registeredComponents.set(componentSchema.name, data);\n    return true;\n  };\n\n  const list = () => {\n    return new Map(_registeredComponents)\n  }\n\n  const isRegistered = (name) => {\n    return _registeredComponents.has(name);\n  }\n\n  return {\n    add,\n    remove,\n    register,\n    list,\n    isRegistered\n  };\n};\n","import {v4 as uuidv4} from 'uuid';\n\nexport const EntityManager = (storage) => {\n  const _storage = storage;\n\n  /**\n   * Add a new entity\n   * @param {string} [id] - Entity Id\n   * @returns {string} - Entity Id\n   */\n  const add = (id) => {\n    const entity = id  || uuidv4();\n    _storage.addEntity(entity);\n    return entity;\n  };\n\n  /**\n   * Remove an entity\n   * @param {*} entity - Entity Id to remove\n   * @returns {boolean} - True if successful, else false\n   */\n  const remove = (entity) => {\n    return _storage.removeEntity(entity);\n  };\n\n  /**\n   * Retrieve an entity\n   * @param {*} id - Entity Id\n   * @returns {*} - Entity Id if it exists. Undefined if it does not exists\n   */\n  const get = (id) => {\n    _storage.getEntity(id);\n    return id;\n  };\n\n  /**\n   * Retrieve all entities stored\n   * @returns {Iterator} - Iterator that list all entities\n   */\n  const list = () => {\n    return _storage.getEntities().values();\n  };\n\n  return {\n    add,\n    get,\n    list,\n    remove,\n  };\n};\n","import { EntityManager } from './entityManager.js';\nimport { ComponentManager } from './componentManager.js';\nimport { SystemManager } from './systemManager.js';\nimport { TemplateManager } from './templateManager';\nimport { Storage } from './storage/index.js';\n\n/**\n * Create an Enki Engine instance\n * @param {string} storageType - The type of storage to use, either 'MemoryStorage' or 'custom'\n * @param {string} mode - debug or production.\n * @param {func} storageInstance - a Storage instance, only used if storageType is set to 'custom'\n * @param {any} rest - unused at the moment\n * @returns {{EntityManager: {add: (function(*): string), remove: remove}, ComponentManager: {add: add, remove: (function(*=, *=): boolean|*), register: register}, SystemManager: {execute: execute, register: register}}}\n * @constructor\n */\nconst Engine = ({storageType = 'MemoryStorage', mode = 'production', storageInstance = null, ...rest} = {}) => {\n\n  //get storage\n  console.log(`Starting Enki ECS Engine with ${storageType}`)\n\n  const verbose = mode == 'debug' ? true : false;\n  let storage = null;\n  if(storageType == 'custom') {\n    storage = storageInstance(verbose);\n  } else {\n    storage = Storage[storageType](verbose);\n  }\n\n  const entityMgr = EntityManager(storage, verbose);\n\n  const componentMgr = ComponentManager(storage, verbose);\n\n  const systemMgr = SystemManager(storage, verbose);\n\n  const templateMgr = TemplateManager(entityMgr, componentMgr,verbose);\n\n  return {\n    EntityManager: entityMgr,\n    SystemManager: systemMgr,\n    ComponentManager: componentMgr,\n    TemplateManager: templateMgr,\n    Storage: storage\n  }\n\n}\n\nexport default Engine;\nexport const _storage = Storage;","import { MemoryStorage } from './memoryStorage';\n\nexport const Storage =  {\n  MemoryStorage\n}\n","/**\n *\n * @param {boolean} verbose - If True will send log to console\n * @param {{Entities: {Set}, ComponentMap:{Map}, EntityComponents: {Map} }} state - Object containing 3 property that must react like Map or Set. Will be used to store the state\n * @returns {{addEntity: (function(*): Set<any>), removeEntityComponent: removeEntityComponent, getEntityComponents: (function(*): any), getEntities: (function(): Set<*>), addEntityComponent: addEntityComponent, getEntity: (function(*=): *), removeEntity: (function(*=): boolean), getEntityByComponents: (function(Array): *)}}\n * @constructor\n */\nexport const MemoryStorage = (verbose, state = {}) => {\n    const _verbose = verbose;\n    const Entities = state.Entities || new Set(); //list of entities created\n    const ComponentMap = state.ComponentMap || new Map(); //a map for quickly retrieve entity that have a given component (ComponentId => [entity1, entity2...])\n    const EntityComponents = state.EntityComponents || new Map(); // a 3D map with primary key being entity ID with a map of all components\n\n    const _log = (...$msg) => {\n        if (verbose) {\n            console.log('Memory Store: ', ...$msg)\n        }\n    }\n\n    /**\n     * Add an Entity to storage\n     * @param {any} entityId - Any value that is unique\n     * @returns {Set<any>}\n     */\n    const addEntity = (entityId) => {\n        EntityComponents.set(entityId, new Map())\n        _log(`Saving Entity ${entityId}`)\n        return Entities.add(entityId)\n    }\n\n    /**\n     * Remove an entity from storage\n     * This delete all its components as well\n     * @param entityId\n     * @returns {boolean}\n     */\n    const removeEntity = (entityId) => {\n        _log(`Removing Entity ${entityId}`)\n        const componentsName = EntityComponents.get(entityId)\n        componentsName.forEach((v,k) => {\n            ComponentMap.get(k).delete(entityId)\n        })\n        EntityComponents.delete(entityId)\n        return Entities.delete(entityId)\n    }\n\n    /**\n     * Return EntityId or undefined if the entity does not exists\n     * @param entityId\n     * @returns {entityId}\n     */\n    const getEntity = (entityId) => {\n        _log(`Get Entity ${entityId}`)\n        const e = Entities.has(entityId) ? entityId : undefined;\n        _log(`Found Entity ${entityId}`)\n        return e\n    }\n\n    /**\n     * Return a Set containing all entities\n     * @returns {Set<any>}\n     */\n    const getEntities = () => {\n        //returning a new set so users can not override the Entities Set by inadvertence\n        return new Set(Entities);\n    }\n\n    /**\n     * Get all components attached to an entity\n     * @param {any} entityId - EntityId to retrieve components from\n     * @returns {Set} - Set of components\n     */\n    const getEntityComponents = (entityId) => {\n        _log(`Get Entity Components for ${entityId}`)\n        return EntityComponents.has(entityId) ? EntityComponents.get(entityId) : new Set();\n    }\n\n    /**\n     * List all entities that have the component attached\n     * @param {array} components - array of components name\n     * @returns {Set} - List of entities\n     */\n    const getEntityByComponents = (components) => {\n        _log(`Get List of Entities by Components for `, components)\n        if (!Array.isArray(components)) {\n            throw Error('Components must be an array');\n        }\n        const e = components.reduce((acc, val) => {\n            if (acc.size == 0) {\n                return ComponentMap.get(val) || new Set();\n            }\n\n            return new Set([...acc].filter(i => {\n                const c = ComponentMap.get(val)\n                if(typeof c === 'undefined') {\n                    return false\n                }\n                return c.has(i)\n            }))\n        }, new Set());\n        _log(`Found Entities`, e)\n        return e;\n    }\n\n    /**\n     * Add a component to an entity\n     * @param {any} entityId - EntityId\n     * @param {string} componentName - Name of Component to add to entity\n     * @param {object} component - Component value for initialisation\n     */\n    const addEntityComponent = (entityId, componentName, component) => {\n        _log(`Add Component ${componentName} to Entity ${entityId}`)\n        if (!ComponentMap.has(componentName)) {\n            ComponentMap.set(componentName, new Set([entityId]));\n            EntityComponents.get(entityId).set(componentName, component);\n        } else {\n            ComponentMap.get(componentName).add(entityId);\n            EntityComponents.get(entityId).set(componentName, component);\n        }\n    }\n\n    /**\n     * Remove Component from an entity\n     * @param {any }entityId - EntityId to remove component from\n     * @param {string} componentName - Component Name\n     * @returns {boolean} - True if successfull\n     */\n    const removeEntityComponent = (entityId, componentName) => {\n        _log(`Remove Component ${componentName} to Entity ${entityId}`)\n        if (!ComponentMap.has(componentName)) {\n            return false;\n        } else {\n            return EntityComponents.get(entityId).delete(componentName) &&\n                ComponentMap.get(componentName).delete(entityId);\n        }\n    }\n\n    /**\n     * Return an object containing the current state\n     * @returns {{ComponentMap: Map<any, any>, EntityComponents: Map<any, any>, Entities: Set<any>}}\n     */\n    const getState = () => {\n        return {\n            Entities,\n            ComponentMap,\n            EntityComponents\n        }\n    }\n\n    return {\n        addEntity,\n        removeEntity,\n        getEntity,\n        getEntities,\n        addEntityComponent,\n        removeEntityComponent,\n        getEntityByComponents,\n        getEntityComponents,\n        getState\n    }\n}\n","import {isArray, isString} from './utils/validate';\n\nexport const SystemManager = (storage, verbose) => {\n\n    const _storage = storage;\n    const _registeredSystems = new Map();\n    const _registerEvents = new Set();\n\n\n    const _log = (...$msg) => {\n        if (verbose) {\n            console.log('System Manager: ', ...$msg)\n        }\n    }\n\n    const _query = (q) => {\n        return _storage.getEntityByComponents(q);\n    }\n\n    const _validate = (system) => {\n        //check that system is a function with the correct prototype\n        if (typeof (system) !== 'function' || !system.hasOwnProperty('query')) {\n            _log('Trying to register a system that is either not a function or does not have a name and query defined');\n            return false;\n        }\n\n        if (!isArray(system.query, 'string')) {\n            _log(`System ${system.name} does not have a correct query. A query must be an array of string.`)\n            return false;\n        }\n\n        if (!isArray(system.events, 'string')) {\n            _log(`System ${system.name} does not have a correct events trigger setup. Systems must have an events property that is an empty array or an array of Events name.`)\n            return false;\n        }\n\n        const res = system()\n        if (!res.hasOwnProperty('execute') || typeof (res.execute) !== 'function') {\n            _log(`System ${system.name} does not have an execute function`)\n            return false\n        }\n\n        if (!res.hasOwnProperty('events') || typeof (res.events) !== 'function') {\n            _log(`System ${system.name} does not have an events function`)\n            return false\n        }\n\n        return true\n    }\n\n\n    /**\n     * Execute all registered systems\n     * @returns {Map{Array}} - Return values from each system\n     */\n    const execute = () => {\n        // loop through all systems\n        const returnValues = new Map();\n        for (let [name, system] of _registeredSystems) {\n            const entities = _query(system.query);\n            returnValues.set(name, new Map())\n            entities.forEach((e) => {\n                returnValues.get(name).set(e, system.instance.execute(_storage.getEntityComponents(e)))\n            })\n        }\n        return returnValues;\n    }\n\n    /**\n     * Register a new system\n     * @param {function} system - A system to be registered\n     * @returns {boolean} - True if successful else false\n     */\n    const register = (system) => {\n        if (_validate(system)) {\n            _log(`Registering ${system.name} System`)\n            _registeredSystems.set(system.name, {instance: system(), query: system.query, events: system.events});\n            return true;\n        } else {\n            _log(`System ${system.name} failed validation and was not registered.`);\n            return false;\n        }\n    }\n\n    /**\n     * Register Event\n     * @param {string} eventName - Event Name\n     * @returns {boolean} - True if registered\n     */\n    const registerEvent = (eventName) => {\n        if (isString(eventName)) {\n            _registerEvents.add(eventName);\n            return true;\n        } else {\n            _log(`Event ${eventName} failed validation and was not registered.`);\n            return false;\n        }\n    }\n\n    const triggerEvent = (eventName, eventData, filter) => {\n        if (!_registerEvents.has(eventName)) {\n            _log(`Event ${eventName} is not registered.`);\n            return false;\n        }\n\n        // loop through all systems\n        const returnValues = new Map();\n        for (let [name, system] of _registeredSystems) {\n            if (system.events.includes(eventName)) {\n                const entities = _query(system.query);\n                returnValues.set(name, new Map())\n                entities.forEach((e) => {\n                    if (!filter || filter.includes(e)) {\n                        returnValues.get(name).set(e, system.instance.events(_storage.getEntityComponents(e), eventName, eventData))\n                    }\n                })\n            }\n        }\n        return returnValues;\n    }\n\n    return {\n        execute,\n        register,\n        registerEvent,\n        triggerEvent\n    }\n\n}\n","import {ValidationError} from './utils/errors';\nimport {isString, isArray, isMap} from './utils/validate'\n\nexport const TemplateManager = (entityMgr, componentMgr, verbose) => {\n    const _registeredTemplates = new Map()\n\n    const _log = (...$msg) => {\n        if (verbose) {\n            console.log('Template Manager: ', ...$msg);\n        }\n    };\n\n\n    /**\n     * Register a new Template for use\n     *\n     * @param {string} name - Name of the template, must be unique\n     * @param {Array} components - Array of Components used by this templates. Cannot be empty.\n     * @param {Map} defaultValues - Map of default Values for each components in `components` param. Key must be a component name.\n     * @param {boolean} registerComponents - If true, will register components if they are not already registered. if false, will fail registration of template if a component is not registered\n     * @returns {Boolean} - True if registered\n     *\n     * @throws ValidationError - Error if the templates is invalid\n     */\n    const register = (name, components, defaultValues = null, registerComponents = true) => {\n        _log('Registering template')\n\n        if (!isString(name)) {\n            throw new ValidationError('Invalid name for template');\n        }\n\n        // check iof template already exists\n        if (_registeredTemplates.has(name)) {\n            throw new ValidationError('A template with this name already exists.');\n        }\n\n        if (!isArray(components, 'components') || components.length == 0) {\n            throw new ValidationError('Invalid components list');\n        }\n\n        // check if all components are registered, if not registered\n        for(let c of components) {\n            if(!componentMgr.isRegistered(c['name']) && registerComponents) {\n                componentMgr.register(c)\n            } else if (!componentMgr.isRegistered(c['name']) && !registerComponents) {\n                throw new ValidationError(`Component ${c['name']} is not registered.`);\n            }\n        }\n\n        if (defaultValues !== null && !isMap(defaultValues)) {\n            throw new ValidationError('defaultValues must be a Map.');\n        }\n\n        _log('Template validation successful')\n\n        _registeredTemplates.set(name, {\n            name,\n            components,\n            defaultValues: defaultValues || new Map()\n        })\n\n\n        return true;\n    }\n\n    /**\n     *  Create an entity based on the given template\n     * @param {string} templateName - Name of the template to use\n     * @param {Map} values - Map of component values\n     * @param {string} [entityId] - Optional Entity Id to use during creation\n     * @returns {string} - Id of the entity added\n     *\n     * @throws ValidationError|Error\n     */\n    const create = (templateName, values, entityId) => {\n        if (!_registeredTemplates.has(templateName)) {\n            throw new ValidationError('Template does not exist');\n        }\n\n        const template = _registeredTemplates.get(templateName);\n\n\n        const id = entityMgr.add(entityId)\n        for (let c of template['components']) {\n            try {\n                // prepare values for component\n                let v = {}\n                if(typeof values !== 'undefined') {\n                    v = values.get(c['name']);\n                }\n                const d = template['defaultValues'].get(c['name']) || {};\n                const data = Object.assign(d, v)\n\n                //add component to entity\n                componentMgr.add(id, c['name'], data)\n            } catch (err) {\n                //we need to delete the entity and all associated components\n                entityMgr.remove(id)\n                _log(`TemplateManager: Failed to add ${c['name']} component to entity.`)\n                _log(err.message)\n\n                //bubble up error\n                throw new Error(`TemplateManager: Failed to add ${c['name']} component to entity during creation.`)\n            }\n\n        }\n\n\n        return id;\n    }\n\n    /**\n     * Return a Map containing all registered templates\n     * @returns {Map<any, any>}\n     */\n    const list = () => {\n        return new Map(_registeredTemplates)\n    }\n\n    /**\n     * Remove a template.\n     * Removing a template does not remove existing enitties created with this template.\n     *\n     * @param {string} templateName - Name of the template to remove\n     * @returns {boolean} - True if template was removed\n     *\n     * @throws ValidationError\n     */\n    const remove = (templateName) => {\n        if (!_registeredTemplates.has(templateName)) {\n            throw new ValidationError('Template does not exist');\n        }\n        return _registeredTemplates.delete(templateName);\n    }\n\n    return {\n        list,\n        register,\n        create,\n        remove\n    };\n};\n","export class ValidationError extends Error {\n    constructor(message) {\n        super(message);\n\n        this.name = 'ValidationError';\n    }\n}\n","import {ValidationError} from './errors'\n\nexport const isNumber = (value) => {\n    return !isNaN(value)\n}\n\nexport const isAny = (value) => {\n    if (typeof (value) !== 'undefined') {\n        return true;\n    }\n    return false;\n}\n\nexport const isString = (value) => {\n    if (typeof value === 'string' || value instanceof String) {\n        return true;\n    }\n    return false;\n}\n\nexport const isEnum = (value, allowed) => {\n    return allowed.includes(value)\n}\n\nexport const isArray = (value, type) => {\n    //check if array\n    if (!Array.isArray(value)) {\n        return false\n    }\n\n    //not checking types\n    if(typeof type == 'undefined') {\n        return true\n    }\n\n    //check type\n    let res = false;\n    switch (type) {\n        case 'string':\n            res = value.reduce((acc, cur) => {\n                return acc && isString(cur)\n            }, true)\n            break;\n        case 'number':\n            res = value.reduce((acc, cur) => {\n                return acc && isNumber(cur)\n            }, true)\n            break;\n        case 'components':\n            res = value.reduce((acc, cur) => {\n                return acc && isComponent(cur)\n            }, true)\n            break;\n        case 'mixed' :\n            res = true;\n            break;\n        case 'any':\n            res = true;\n            break;\n        default:\n            throw new ValidationError(`Type ${type} not supported in Array`);\n    }\n    return res;\n}\n\nexport const isMap = (value, type) => {\n    if (! (value instanceof Map)) {\n        return false\n    }\n\n    let values = Array.from(value.values())\n\n    return isArray(values, type)\n\n}\n\nexport const isSet = (value, type) => {\n    if (! (value instanceof Set)) {\n        return false\n    }\n\n    let values = Array.from(value.values())\n\n    return isArray(values, type)\n}\n\nexport const isComponent = (value) => {\n    if (!value.hasOwnProperty('name')) {\n        return false;\n    }\n\n    // data is optional because we can have flag components\n    // but if we have data, it must have the correct structure\n    if (value.hasOwnProperty('data')) {\n        //check if data is an object and make sure all entries have a type property defined.\n        const data = Object.entries(value.data);\n        //if value.data is not iterable, then it returns an empty array\n        if (data.length == 0) {\n            return false\n        }\n        //check that the actual values of data are correct.\n        return data.reduce((acc, cur) => {\n            return acc\n                && cur.length > 1\n                && isString(cur[0]) // property key must be a string\n                && cur[1].hasOwnProperty('type') // value of each data must contain a `type` property\n                && isEnum(cur[1]['type'], ['string', 'number', 'any', 'mixed']) // check if `type` is supported\n        }, true)\n        \n    }\n\n    return true;\n\n\n}"],"sourceRoot":""}